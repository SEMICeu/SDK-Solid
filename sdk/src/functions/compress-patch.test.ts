import { describe, expect, test } from 'vitest';
import { Patch } from '../models/patch-model';
import { compressPatch } from './compress-patch';

describe('compressPatch', () => {

  test('should conform to PoC', async () => {

    await expect(compressPatch(JSON.parse('{"conditions":{"tos_uri":"https://example.com/tos","policy_uri":"https://example.com/policy","legal_basis_uri":["https://example.com/legal-basis"],"purpose_uri":["https://example.com/purpose"]},"add":{"access":{"subject_type_combo":[{"applies_to_subject_uri":"https://dev-use.id/tom-20nov231","applies_to_type_uri":"https://elia.com/consent","allowed_subject_uri":"https://dev-use.id/tom-20nov231","allowed_azp_uri":"https://sandbox.webid.solid4energy.eliagroup.io/","allowed_issuer_uri":"*","allowed_access_mode":"read","storage":"*"},{"applies_to_subject_uri":"https://dev-use.id/tom-20nov231","applies_to_type_uri":"https://elia.com/consent","allowed_subject_uri":"https://dev-use.id/tom-20nov231","allowed_azp_uri":"https://sandbox.webid.solid4energy.eliagroup.io/","allowed_issuer_uri":"*","allowed_access_mode":"write","storage":"*"},{"applies_to_subject_uri":"https://dev-use.id/tom-20nov231","applies_to_type_uri":"https://elia.com/consent","allowed_subject_uri":"https://dev-use.id/tom-20nov231","allowed_azp_uri":"https://sandbox.webid.solid4energy.eliagroup.io/","allowed_issuer_uri":"*","allowed_access_mode":"create","storage":"*"},{"applies_to_subject_uri":"https://dev-use.id/tom-20nov231","applies_to_type_uri":"https://elia.com/contract","allowed_subject_uri":"https://dev-use.id/tom-20nov231","allowed_azp_uri":"https://sandbox.webid.solid4energy.eliagroup.io/","allowed_issuer_uri":"*","allowed_access_mode":"read","storage":"*"},{"applies_to_subject_uri":"https://dev-use.id/tom-20nov231","applies_to_type_uri":"https://elia.com/contract","allowed_subject_uri":"https://dev-use.id/tom-20nov231","allowed_azp_uri":"https://sandbox.webid.solid4energy.eliagroup.io/","allowed_issuer_uri":"*","allowed_access_mode":"write","storage":"*"},{"applies_to_subject_uri":"https://dev-use.id/tom-20nov231","applies_to_type_uri":"https://elia.com/contract","allowed_subject_uri":"https://dev-use.id/tom-20nov231","allowed_azp_uri":"https://sandbox.webid.solid4energy.eliagroup.io/","allowed_issuer_uri":"*","allowed_access_mode":"create","storage":"*"},{"applies_to_subject_uri":"https://dev-use.id/tom-20nov231","applies_to_type_uri":"https://elia.com/measurement","allowed_subject_uri":"https://dev-use.id/tom-20nov231","allowed_azp_uri":"https://sandbox.webid.solid4energy.eliagroup.io/","allowed_issuer_uri":"*","allowed_access_mode":"read","storage":"*"},{"applies_to_subject_uri":"https://dev-use.id/tom-20nov231","applies_to_type_uri":"https://elia.com/measurement","allowed_subject_uri":"https://dev-use.id/tom-20nov231","allowed_azp_uri":"https://sandbox.webid.solid4energy.eliagroup.io/","allowed_issuer_uri":"*","allowed_access_mode":"write","storage":"*"},{"applies_to_subject_uri":"https://dev-use.id/tom-20nov231","applies_to_type_uri":"https://elia.com/measurement","allowed_subject_uri":"https://dev-use.id/tom-20nov231","allowed_azp_uri":"https://sandbox.webid.solid4energy.eliagroup.io/","allowed_issuer_uri":"*","allowed_access_mode":"create","storage":"*"},{"applies_to_subject_uri":"https://dev-use.id/tom-20nov231","applies_to_type_uri":"https://elia.com/picture","allowed_subject_uri":"https://dev-use.id/tom-20nov231","allowed_azp_uri":"https://sandbox.webid.solid4energy.eliagroup.io/","allowed_issuer_uri":"*","allowed_access_mode":"read","storage":"*"},{"applies_to_subject_uri":"https://dev-use.id/tom-20nov231","applies_to_type_uri":"https://elia.com/picture","allowed_subject_uri":"https://dev-use.id/tom-20nov231","allowed_azp_uri":"https://sandbox.webid.solid4energy.eliagroup.io/","allowed_issuer_uri":"*","allowed_access_mode":"write","storage":"*"},{"applies_to_subject_uri":"https://dev-use.id/tom-20nov231","applies_to_type_uri":"https://elia.com/picture","allowed_subject_uri":"https://dev-use.id/tom-20nov231","allowed_azp_uri":"https://sandbox.webid.solid4energy.eliagroup.io/","allowed_issuer_uri":"*","allowed_access_mode":"create","storage":"*"},{"applies_to_subject_uri":"https://dev-use.id/tom-20nov231","applies_to_type_uri":"https://elia.com/picture","allowed_subject_uri":"https://sandbox.nest-solid.com/","allowed_azp_uri":"*","allowed_issuer_uri":"*","allowed_access_mode":"read","storage":"*"},{"applies_to_subject_uri":"https://dev-use.id/tom-20nov231","applies_to_type_uri":"https://elia.com/contract","allowed_subject_uri":"https://sandbox.nest-solid.com/","allowed_azp_uri":"*","allowed_issuer_uri":"*","allowed_access_mode":"read","storage":"*"},{"applies_to_subject_uri":"https://dev-use.id/tom-20nov231","applies_to_type_uri":"https://elia.com/contract","allowed_subject_uri":"https://sandbox.nest-solid.com/","allowed_azp_uri":"*","allowed_issuer_uri":"*","allowed_access_mode":"write","storage":"*"},{"applies_to_subject_uri":"https://dev-use.id/tom-20nov231","applies_to_type_uri":"https://elia.com/contract","allowed_subject_uri":"https://sandbox.nest-solid.com/","allowed_azp_uri":"*","allowed_issuer_uri":"*","allowed_access_mode":"create","storage":"*"},{"applies_to_subject_uri":"https://dev-use.id/tom-20nov231","applies_to_type_uri":"https://elia.com/measurement","allowed_subject_uri":"https://sandbox.realto-solid.com/","allowed_azp_uri":"*","allowed_issuer_uri":"*","allowed_access_mode":"read","storage":"*"},{"applies_to_subject_uri":"https://dev-use.id/tom-20nov231","applies_to_type_uri":"https://elia.com/measurement","allowed_subject_uri":"https://sandbox.realto-solid.com/","allowed_azp_uri":"*","allowed_issuer_uri":"*","allowed_access_mode":"write","storage":"*"},{"applies_to_subject_uri":"https://dev-use.id/tom-20nov231","applies_to_type_uri":"https://elia.com/measurement","allowed_subject_uri":"https://sandbox.realto-solid.com/","allowed_azp_uri":"*","allowed_issuer_uri":"*","allowed_access_mode":"create","storage":"*"},{"applies_to_subject_uri":"https://dev-use.id/tom-20nov231","applies_to_type_uri":"https://elia.com/contract","allowed_subject_uri":"https://sandbox.realto-solid.com/","allowed_azp_uri":"*","allowed_issuer_uri":"*","allowed_access_mode":"read","storage":"*"}],"resource":[]}},"remove":{"access":{"subject_type_combo":[],"resource":[]}}}') as Patch))
      .resolves.toEqual('G6IXAJwHdgyxyhI4TqJ1raN5qV8c3OoTo5qlr0tniWxV2Zv//1c7PiYDoG+drQ2k7NNoO60rR4Fpiv0bFUbSIrvgP3lKvHkVd2Dp4HYl++J4mZnF0C5j2bddgb6t2qg2RKmMSkXgrK0c70qjSR7gQHzl2BqbggeTcugVzFxm4CgJVguSDPIR9gWREsiWNLVoNFLSke/rc06W2z5vquHRtDVoXTq8IAkqOvaLG3UBftlwz8y8x56pPZYyzDD1iTt5BwyNjgbKYhgEw4+FG8tAKKW5OLtJTQVXSQiYFJMUhUan0viP+gOZSACUXRVKr+e63N6oCxpTig2zEoWymp0PQzicBRvG6axCObWFkZgm5HzL0hG+BMCCkCcdAPVg3XJHOrHc/pQJk/kc1nsHCCI3MFOxnGt2SPzFBYvbKA/AM4UngFOxWLsTGa7onSug9C8q1rqvu656cftl');

  });

});

